<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Scanner NPP</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>üß™ Scanner NPP ‚Äì Potencial del Producto</h1>
    <div id="scanner"></div>
  </div>

  <script>
    const preguntas = [
      {
        titulo: "üß© SECCI√ìN 1 ‚Äì NICHO",
        clave: "nicho",
        items: [
          ["¬øTiene una comunidad con intereses claros?", ["S√≠", "No"], [1, 0]],
          ["¬øEs un nicho con alta recompra?", ["Alta", "Media", "Baja"], [1, 0.5, 0]],
          ["¬øSe encuentra poco saturado en TikTok?", ["Poco saturado", "Saturado", "Muy saturado"], [1, 0.5, 0]],
          ["¬øPuedes conectarte emocionalmente con ese nicho?", ["S√≠", "No"], [1, 0]],
        ]
      },
      {
        titulo: "üì¶ SECCI√ìN 2 ‚Äì PRODUCTO DESEABLE",
        clave: "producto",
        items: [
          ["¬øResuelve un problema espec√≠fico o urgente?", ["S√≠", "No"], [1, 0]],
          ["¬øSe puede demostrar f√°cilmente en video?", ["Muy visual", "Poco visual", "Nada visual"], [1, 0.5, 0]],
          ["¬øTiene un efecto WOW o factor viral?", ["S√≠", "No"], [1, 0]],
          ["¬øEs de compra impulsiva (menos de $600)?", ["S√≠", "No"], [1, 0]],
          ["¬øTiene alta posibilidad de recompra o venta cruzada?", ["S√≠", "No"], [1, 0]]
        ]
      },
      {
        titulo: "ü§ù SECCI√ìN 3 ‚Äì PROVEEDOR RENTABLE",
        clave: "proveedor",
        items: [
          ["¬øEl proveedor acepta pago contra entrega o dropshipping?", ["S√≠", "No"], [1, 0]],
          ["¬øEl costo del producto permite un margen del 40% o m√°s?", ["S√≠", "No"], [1, 0]],
          ["¬øEl proveedor ya tiene log√≠stica automatizada?", ["S√≠", "No"], [1, 0]],
          ["¬øEl env√≠o no supera los $100 MXN y es nacional?", ["S√≠", "No"], [1, 0]],
          ["¬øTiene buenas rese√±as o pruebas de cumplimiento?", ["S√≠", "No"], [1, 0]]
        ]
      }
    ];

    let pagina = 0;
    let puntajes = { nicho: [], producto: [], proveedor: [] };
    let respuestas = [];
    let nombreProducto = "";

    const contenedor = document.getElementById("scanner");

    function cargarPagina() {
      contenedor.innerHTML = "";

      const seccion = preguntas[pagina];
      const form = document.createElement("form");
      form.classList.add("resultado-panel");

      if (pagina === 0) {
        const label = document.createElement("label");
        label.textContent = "Nombre del producto:";
        const input = document.createElement("input");
        input.type = "text";
        input.required = true;
        input.oninput = e => nombreProducto = e.target.value;
        form.appendChild(label);
        form.appendChild(input);
      }

      const h2 = document.createElement("h3");
      h2.textContent = seccion.titulo;
      form.appendChild(h2);

      respuestas = [];

      seccion.items.forEach(([pregunta, opciones, valores], i) => {
        const preguntaDiv = document.createElement("div");
        preguntaDiv.classList.add("resultado-seccion");

        const p = document.createElement("p");
        p.textContent = pregunta;
        preguntaDiv.appendChild(p);

        const group = document.createElement("div");
        group.style.display = "flex";
        group.style.flexDirection = "column";
        const respuesta = { value: -1 };

        opciones.forEach((opcion, j) => {
          const label = document.createElement("label");
          const radio = document.createElement("input");
          radio.type = "radio";
          radio.name = `pregunta${i}`;
          radio.value = valores[j];
          radio.onclick = () => respuesta.value = parseFloat(radio.value);
          label.appendChild(radio);
          label.appendChild(document.createTextNode(" " + opcion));
          group.appendChild(label);
        });

        respuestas.push(respuesta);
        preguntaDiv.appendChild(group);
        form.appendChild(preguntaDiv);
      });

      const btn = document.createElement("button");
      btn.type = "submit";
      btn.textContent = "Siguiente";
      form.appendChild(btn);

      form.onsubmit = (e) => {
        e.preventDefault();
        if (respuestas.some(r => r.value === -1)) {
          alert("Por favor responde todas las preguntas.");
          return;
        }
        puntajes[seccion.clave] = respuestas.map(r => r.value);
        pagina++;
        if (pagina < preguntas.length) cargarPagina();
        else mostrarResultado();
      };

      contenedor.appendChild(form);
    }

    function mostrarResultado() {
      contenedor.innerHTML = "";

      let exitosos = 0;
      let fallas = [];

      const resultados = [
        ["Nicho", "nicho", "Apto", "No apto"],
        ["Producto", "producto", "Ganador", "No ganador"],
        ["Proveedor", "proveedor", "Viable", "No viable"]
      ];

      const resultadoDiv = document.createElement("div");
      resultadoDiv.classList.add("resultado-panel");

      const titulo = document.createElement("h2");
      titulo.textContent = exitosos === 3 ? "‚úÖ ¬°Tu producto es APTO para TikTok Shop!" : "‚ö†Ô∏è Tu producto necesita ajustes antes de lanzar";

      const resumenList = document.createElement("div");
      resumenList.classList.add("resultado-seccion");

      resultados.forEach(([nombre, clave, exito, fallo]) => {
        const total = puntajes[clave].length;
        const puntos = puntajes[clave].reduce((a, b) => a + b, 0);
        const porcentaje = (puntos / total) * 100;
        const estado = porcentaje >= 80 ? exito : fallo;
        if (estado === exito) exitosos++; else fallas.push(clave);

        const fila = document.createElement("div");
        fila.classList.add("resultado-linea");
        fila.innerHTML = `<span>${nombre}:</span><span>${estado} (${puntos.toFixed(1)}/${total} - ${porcentaje.toFixed(0)}%)</span>`;
        resumenList.appendChild(fila);
      });

      const intro = document.createElement("div");
      intro.classList.add("conclusion");
      intro.innerHTML = exitosos === 3
        ? "‚úÖ ¬°Felicidades! Tu producto cumple con los criterios necesarios para tener √©xito en TikTok Shop."
        : "‚ö†Ô∏è Tu producto necesita mejorar en algunas √°reas antes de ser lanzado en TikTok Shop.";

      if (fallas.length) {
        const ul = document.createElement("ul");
        ul.style.marginTop = "10px";
        if (fallas.includes("nicho")) ul.innerHTML += `<li>üîç Mejora tu nicho: busca una comunidad m√°s clara o menos saturada.</li>`;
        if (fallas.includes("producto")) ul.innerHTML += `<li>üì¶ Mejora el producto: que sea m√°s visual, urgente o viral.</li>`;
        if (fallas.includes("proveedor")) ul.innerHTML += `<li>üöö Mejora tu proveedor: busca mejores condiciones log√≠sticas o de margen.</li>`;
        intro.appendChild(ul);
      }

      const encabezado = document.createElement("h3");
      encabezado.textContent = `üì¶ Resultado para: ${nombreProducto}`;

      const reinicio = document.createElement("button");
      reinicio.textContent = "üîÅ Volver a empezar";
      reinicio.onclick = () => location.reload();

      resultadoDiv.appendChild(encabezado);
      resultadoDiv.appendChild(intro);
      resultadoDiv.appendChild(resumenList);
      resultadoDiv.appendChild(reinicio);

      contenedor.appendChild(resultadoDiv);
    }

    cargarPagina();
  </script>
</body>
</html>
